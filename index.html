<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>InColor – 당신의 첫사랑은 무슨 색?</title>
<style>
  :root{
    --brand:#6a5cff;
    --ink:#222;
    --sub:#666;
    --bg:#f7f7fb;
    --card:#ffffff;
    --line:#e7e7ef;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", sans-serif;
    line-height:1.5;
  }
  .wrap{max-width:720px; margin:32px auto; padding:0 16px}
  .card{
    background:var(--card); border:1px solid var(--line);
    border-radius:16px; padding:24px; box-shadow:0 6px 20px rgba(0,0,0,0.06);
  }
  h1{margin:0 0 8px; font-size:28px; letter-spacing:-0.2px; color:var(--brand)}
  .sub{color:var(--sub); margin:0 0 24px}
  .row{display:flex; gap:12px; flex-wrap:wrap}
  .btn{
    appearance:none; border:1px solid var(--line); background:#fff; color:var(--ink);
    padding:14px 16px; border-radius:12px; cursor:pointer; font-weight:600; flex:1 1 240px;
    transition:transform .06s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .btn:hover,.btn:focus{outline:none; border-color:var(--brand); box-shadow:0 0 0 4px rgba(106,92,255,.12)}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:var(--brand); color:#fff; border-color:var(--brand)}
  .meta{display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin:8px 0 24px}
  .field{display:flex; flex-direction:column; gap:6px; min-width:180px}
  .input, .select{
    width:100%; padding:12px 14px; border:1px solid var(--line); border-radius:10px; background:#fff;
  }
  .progress{
    height:10px; background:#eaeaf6; border-radius:999px; overflow:hidden; margin:8px 0 24px;
  }
  .bar{height:100%; width:0%; background:linear-gradient(90deg, var(--brand), #a58bff); transition:width .3s ease}
  .q-title{font-size:20px; font-weight:700; margin:0 0 8px}
  .q-help{color:var(--sub); margin:0 0 18px; font-size:14px}
  .fade{animation:fade .24s ease}
  @keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}
  .result{
    display:flex; gap:20px; align-items:flex-start; flex-wrap:wrap;
  }
  .chip{
    width:64px; height:64px; border-radius:50%; border:2px solid #fff; box-shadow:0 6px 14px rgba(0,0,0,.12)
  }
  .result h2{margin:0 0 6px; font-size:24px}
  .tag{display:inline-block; padding:4px 10px; border-radius:999px; border:1px solid var(--line); color:var(--sub); font-size:13px; margin-right:6px}
  .notes{margin-top:14px; color:var(--sub); font-size:14px}
  .hr{height:1px; background:var(--line); margin:20px 0}
  .hint{font-size:12px; color:var(--sub)}
  .footer{margin-top:12px; font-size:12px; color:var(--sub); text-align:center}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card fade" id="view-intro" aria-live="polite">
      <h1>InColor</h1>
      <p class="sub">몇 가지 질문에 답하면 당신의 첫사랑을 닮은 색을 알려드립니다. 12가지 결과 중 하나가 도출됩니다.</p>

      <div class="meta">
        <div class="field" style="flex:1 1 260px">
          <label for="nickname">닉네임(선택)</label>
          <input id="nickname" class="input" placeholder="방송에서 호명 시 사용할 이름" />
        </div>
        <div class="field" style="flex:1 1 180px">
          <label for="consent">사연 공개 동의</label>
          <select id="consent" class="select" aria-label="사연 공개 동의">
            <option value="no">아니오</option>
            <option value="yes">예</option>
          </select>
          <span class="hint">추첨 시 일부 사연이 소개될 수 있습니다.</span>
        </div>
      </div>

      <div class="row">
        <button class="btn btn-primary" id="start">시작하기</button>
        <button class="btn" id="how">진행 안내 보기</button>
      </div>

      <div class="hr"></div>
      <details>
        <summary>색상 리스트와 키워드 보기</summary>
        <p class="hint" style="margin-top:8px">
          Red(열정), Pink(달콤), Orange(활기), Yellow(밝음), Green(안정), Mint(청량),
          Blue(차분), Navy(깊이), Purple(신비), Lavender(포근), White(순수), Black(이별)
        </p>
      </details>
    </div>

    <div class="card fade" id="view-quiz" hidden>
      <div class="progress" aria-hidden="true"><div class="bar" id="bar"></div></div>
      <div id="qbox"></div>
    </div>

    <div class="card fade" id="view-result" hidden>
      <div class="result">
        <div><div id="chip" class="chip"></div></div>
        <div>
          <h2 id="title"></h2>
          <div id="tags"></div>
          <p class="notes" id="desc"></p>
        </div>
      </div>

      <div class="hr"></div>

      <div class="field">
        <label for="story">사연 한 줄(선택)</label>
        <input id="story" class="input" placeholder="예) 봄 햇살처럼 따뜻해서 Yellow." maxlength="120" />
        <span class="hint">120자 이내. 제출 시 현장 통계 및 추첨에 활용됩니다.</span>
      </div>

      <div class="row" style="margin-top:14px">
        <button class="btn btn-primary" id="share">결과 공유/복사</button>
        <button class="btn" id="restart">다시 하기</button>
      </div>

      <p class="footer">© InColor · 현장 체험 부스용 간이 설문</p>
    </div>
  </div>

<script>
/* ===== 데이터: 12색 팔레트/설명 ===== */
const COLOR_INFO = {
  Red:      {hex:"#e53935", tags:["열정","강렬"], desc:"설렘이 불꽃처럼 번졌던 기억. 끌림과 직진이 컸던 첫사랑."},
  Pink:     {hex:"#ff6ea9", tags:["달콤","수줍음"], desc:"두근거림을 조심스레 숨기던 시절. 사소한 손짓도 오래 남았던 기억."},
  Orange:   {hex:"#ff8c42", tags:["활기","즐거움"], desc:"만나면 웃음이 먼저. 데이트가 소풍 같았던 밝은 온도의 사랑."},
  Yellow:   {hex:"#ffd23f", tags:["밝음","행복"], desc:"햇살 같은 미소와 가벼운 농담, 마음이 환해지는 동행."},
  Green:    {hex:"#43a047", tags:["안정","성장"], desc:"서로를 지지하며 차분히 자라난 관계. 편안함이 곧 설렘이었던 시기."},
  Mint:     {hex:"#2ec4b6", tags:["청량","신선"], desc:"첫 만남의 상쾌한 공기. 바람처럼 시원하고 맑았던 느낌."},
  Blue:     {hex:"#1e88e5", tags:["차분","평화"], desc:"파문 없이 잔잔히 스며드는 마음. 오래두고 곱씹어도 담백한 여운."},
  Navy:     {hex:"#2d3a64", tags:["깊이","그리움"], desc:"한 장 더 넘기고 싶은 긴 소설. 시간이 지나도 묵직한 그리움."},
  Purple:   {hex:"#8e24aa", tags:["신비","특별"], desc:"설명하기 어려운 우연과 기척. 특별히 다른 결의 만남."},
  Lavender: {hex:"#b57edc", tags:["섬세","포근"], desc:"거칠었던 하루를 부드럽게 감싸준 위로. 은은하게 남는 향처럼."},
  White:    {hex:"#f5f7fb", tags:["순수","시작"], desc:"모르는 게 더 많았던 초심의 시간. 흰 종이 같은 첫 페이지."},
  Black:    {hex:"#1a1a1a", tags:["비밀","이별"], desc:"끝내 담아두어야 했던 이야기. 미완이라 더 선명한 기억."
};

/* ===== 질문 트리(2지선다 · 최대 3~4클릭) =====
 흐름은 다음과 같다:
 Q0 -> (A) -> Q1a  | (B) -> Q1b
 Q1a -> (A) -> Q2a | (B) -> Q2b
 Q1b -> (A) -> Q2c | (B) -> Q2d
 최종 Q2x는 각각 3가지 색 중 선택지 2개 + 망설임/보조 옵션으로 12색 완주
*/
const QUESTIONS = [
  { id:"Q0",
    title:"첫사랑은 어떤 분위기였나요?",
    help:"느낌에 가까운 쪽을 선택하세요.",
    a:{ text:"뜨겁고 설렘 가득", next:"Q1a" },
    b:{ text:"잔잔하고 포근",   next:"Q1b" }
  },
  { id:"Q1a",
    title:"감정의 결은 어땠나요?",
    help:"강렬함 vs 차분함",
    a:{ text:"강렬하고 불꽃 같았다", next:"Q2a" },
    b:{ text:"차분하고 깊었다",     next:"Q2b" }
  },
  { id:"Q1b",
    title:"어떤 결이 더 가까웠나요?",
    help:"친구 같음 vs 은근한 울림",
    a:{ text:"포근히 지지하며 성장", next:"Q2c" },
    b:{ text:"조용히 마음을 울림",   next:"Q2d" }
  },

  // Red / Orange / Pink
  { id:"Q2a",
    title:"가장 가까운 느낌을 골라주세요",
    help:"강렬 그룹(Red/Orange/Pink)",
    a:{ text:"열정과 강렬함",  result:"Red"    },
    b:{ text:"즐겁고 밝은 에너지", next:"Q2a_ref" }
  },
  { id:"Q2a_ref",
    title:"더 가깝다면 선택하세요",
    help:"활기 vs 달콤",
    a:{ text:"활기와 유쾌함",  result:"Orange" },
    b:{ text:"달콤하고 수줍음", result:"Pink"   }
  },

  // Blue / Navy / Purple
  { id:"Q2b",
    title:"가장 가까운 느낌을 골라주세요",
    help:"차분 그룹(Blue/Navy/Purple)",
    a:{ text:"차분하고 담백", result:"Blue"  },
    b:{ text:"깊은 그리움과 진중함", next:"Q2b_ref" }
  },
  { id:"Q2b_ref",
    title:"더 가깝다면 선택하세요",
    help:"깊이 vs 신비",
    a:{ text:"깊이와 그리움", result:"Navy"   },
    b:{ text:"신비롭고 특별", result:"Purple" }
  },

  // Green / Yellow / Mint
  { id:"Q2c",
    title:"가장 가까운 느낌을 골라주세요",
    help:"편안 그룹(Green/Yellow/Mint)",
    a:{ text:"안정과 상호 성장", result:"Green" },
    b:{ text:"밝고 해맑은 웃음", next:"Q2c_ref" }
  },
  { id:"Q2c_ref",
    title:"더 가깝다면 선택하세요",
    help:"밝음 vs 청량",
    a:{ text:"밝음과 행복", result:"Yellow" },
    b:{ text:"청량하고 신선", result:"Mint"   }
  },

  // Lavender / White / Black
  { id:"Q2d",
    title:"가장 가까운 느낌을 골라주세요",
    help:"섬세 그룹(Lavender/White/Black)",
    a:{ text:"섬세하고 포근", result:"Lavender" },
    b:{ text:"순수하고 깨끗", next:"Q2d_ref" }
  },
  { id:"Q2d_ref",
    title:"더 가깝다면 선택하세요",
    help:"순수 vs 미완",
    a:{ text:"순수한 시작", result:"White" },
    b:{ text:"미완의 여운", result:"Black" }
  }
];

/* ===== 상태 및 엘리먼트 ===== */
const $intro   = document.getElementById("view-intro");
const $quiz    = document.getElementById("view-quiz");
const $result  = document.getElementById("view-result");
const $qbox    = document.getElementById("qbox");
const $bar     = document.getElementById("bar");
const $start   = document.getElementById("start");
const $how     = document.getElementById("how");
const $title   = document.getElementById("title");
const $desc    = document.getElementById("desc");
const $tags    = document.getElementById("tags");
const $chip    = document.getElementById("chip");
const $share   = document.getElementById("share");
const $restart = document.getElementById("restart");
const $story   = document.getElementById("story");
const $nick    = document.getElementById("nickname");
const $consent = document.getElementById("consent");

let flow = [];     // 지나온 질문 id 기록
let currentId = "Q0";

/* ===== 유틸 ===== */
function setView(intro=false, quiz=false, result=false){
  $intro.hidden  = !intro;
  $quiz.hidden   = !quiz;
  $result.hidden = !result;
}
function progress(){
  // 최대 4단계로 가정(인트로 제외). 진행률 바 계산
  const maxSteps = 4;
  const pct = Math.min(100, Math.round((flow.length / maxSteps) * 100));
  $bar.style.width = pct + "%";
}
function renderQuestion(id){
  const node = QUESTIONS.find(q=>q.id===id);
  if(!node) return;
  currentId = id;
  flow = [...flow, id];
  progress();
  const aLabel = node.a.text;
  const bLabel = node.b.text;
  const html = `
    <div class="q-title">${node.title}</div>
    <div class="q-help">${node.help || ""}</div>
    <div class="row">
      <button class="btn btn-primary" id="A">${aLabel}</button>
      <button class="btn" id="B">${bLabel}</button>
    </div>
    <div class="hint">Tip: 선택이 어려우면 더 자주 떠오르는 장면을 기준으로 고르세요.</div>
  `;
  $qbox.innerHTML = html;
  document.getElementById("A").addEventListener("click", ()=>advance(node, "a"));
  document.getElementById("B").addEventListener("click", ()=>advance(node, "b"));
}
function advance(node, choiceKey){
  const choice = node[choiceKey];
  if(choice.result){
    showResult(choice.result);
  }else{
    renderQuestion(choice.next);
  }
}
function showResult(name){
  const color = COLOR_INFO[name];
  if(!color) return;
  setView(false,false,true);
  // 제목/칩/태그/설명
  const nick = ($nick.value || "").trim();
  const head = nick ? `${nick}의 첫사랑 색깔은 ${name}` : `당신의 첫사랑 색깔은 ${name}`;
  $title.textContent = head;
  $chip.style.background = color.hex;
  $chip.style.borderColor = color.name === "White" ? "#ddd" : "#fff";
  $desc.textContent = color.desc;
  $tags.innerHTML = color.tags.map(t=>`<span class="tag">${t}</span>`).join("");

  // 스크롤 상단으로
  window.scrollTo({top:0, behavior:"smooth"});
}
function shareOrCopy(){
  const nick = ($nick.value || "").trim();
  const consent = $consent.value === "yes" ? "사연 공개 동의: 예" : "사연 공개 동의: 아니오";
  const story = ($story.value || "").trim();
  const title = $title.textContent;
  // 색상명 추출
  const colorName = title.split(" ").pop();
  const payload = `[InColor]\n${title}\n색상 키워드: ${COLOR_INFO[colorName]?.tags.join(", ") || ""}\n${story ? "사연: "+story+"\n":""}${consent}`;

  if(navigator.share){
    navigator.share({title:"InColor – 첫사랑의 색", text:payload})
      .catch(()=>copyFallback(payload));
  }else{
    copyFallback(payload);
  }
}
function copyFallback(text){
  navigator.clipboard?.writeText(text).then(()=>{
    alert("결과가 클립보드에 복사되었습니다.");
  }).catch(()=>{
    // 입력창을 만들어 선택-복사 시도
    const ta = document.createElement("textarea");
    ta.value = text; document.body.appendChild(ta);
    ta.select(); try{ document.execCommand("copy"); alert("결과가 클립보드에 복사되었습니다."); }catch(e){ alert("복사에 실패했습니다. 텍스트를 직접 선택해 복사하세요."); }
    document.body.removeChild(ta);
  });
}
function resetAll(){
  flow = [];
  currentId = "Q0";
  $story.value = "";
  setView(true,false,false);
}

/* ===== 이벤트 바인딩 ===== */
$start.addEventListener("click", ()=>{
  setView(false,true,false);
  renderQuestion("Q0");
});
$how.addEventListener("click", ()=>{
  alert("진행 방법\n1) 질문에 2지선다로 답합니다.\n2) 최대 3~4번 선택 후 12가지 색 중 하나가 결과로 도출됩니다.\n3) 결과 카드에서 사연 한 줄을 적고 공유/복사할 수 있습니다.");
});
$share.addEventListener("click", shareOrCopy);
$restart.addEventListener("click", resetAll);

/* 초기 접근성: 엔터로 시작 가능 */
document.addEventListener("keydown", (e)=>{
  if(!$intro.hidden && (e.key==="Enter" || e.key===" ")){
    setView(false,true,false);
    renderQuestion("Q0");
  }
});
</script>
</body>
</html>
